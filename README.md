# Simple Blog App

Мини-блог со следующими функциями:
- регистрация и вход пользователя (JWT);
- создание, редактирование, удаление постов с видимостью `public` / `followers` / `request`;
- подписки на пользователей и лента по подпискам;
- теги и фильтрация постов по тегу;
- публичные посты доступны без подписки; скрытые посты открываются только по явному запросу;
- комментарии к постам;
- простая web-страница на fetch для работы с API.

## Быстрый старт
1) Установите зависимости:
```
npm install
```
2) Запустите сервер:
```
npm start
```
3) Откройте в браузере `http://localhost:3000/`.

Файл БД хранится в `data.sqlite` в корне проекта. Для разработки секрет JWT задаётся переменной `JWT_SECRET` (по умолчанию используется dev-значение).

## API (кратко)
- `POST /api/register {username, password}`
- `POST /api/login {username, password}` -> `{token}`
- `POST /api/follow {username}` (JWT)
- `GET /api/following` (JWT)
- `POST /api/posts {title, content, visibility, tags}` (JWT)
- `PUT /api/posts/:id` (JWT, владелец)
- `DELETE /api/posts/:id` (JWT, владелец)
- `GET /api/posts/public`
- `GET /api/posts/feed` (JWT)
- `GET /api/posts/tag/:tag` (JWT)
- `GET /api/posts/:id[?request=1]` (JWT; для hidden-постов нужен `request=1` или автор)
- `POST /api/posts/:id/comments {content}` (JWT)
- `GET /api/posts/:id/comments` (JWT)

## Анализ выполнения (7+ пунктов)
1. Архитектура: backend на Express + SQLite; хранение пользователей, постов, подписок, комментариев; простое SPA на статическом HTML.
2. Безопасность: JWT для всех защищённых эндпоинтов; хеширование пароля через bcrypt; проверка владельца на редактирование/удаление.
3. Видимость постов: три уровня (`public`, `followers`, `request`); скрытые посты требуют явного флага `?request=1`, иначе 403 с подсказкой.
4. Подписки и лента: таблица `follows`, лента строится по авторам, на которых подписан пользователь, с учётом видимости.
5. Теги: сохраняются строкой, фильтрация по подстроке; UI позволяет вводить теги через запятую и фильтровать.
6. Комментарии: проверка доступа к посту перед созданием/чтением; сортировка по времени.
7. UX: минималистичный фронт с fetch; отображение токена, форм для постов, подписок, фильтров и комментариев; статус-лог внизу.
8. Данные: автоматическое создание схемы БД при запуске; хранение дат создания; каскадное удаление комментариев при удалении поста реализовано приложением.

## Рекомендации по улучшению и устранению рисков
- Заменить dev-секрет JWT на секрет из окружения, добавить ротацию токенов.
- Добавить валидацию длины/формата полей и централизованный обработчик ошибок.
- Ввести rate limiting и блокировку частых логинов для защиты от брутфорса.
- Добавить пагинацию для фидов и фильтров, чтобы избежать больших выборок.
- Расширить модель hidden-постов: явные запросы/апрув автора вместо query-параметра.
- Написать авто-тесты (unit/интеграционные) и e2e-сценарии UI.
- Подключить миграции для схемы БД и резервное копирование файла `data.sqlite`.
- Вынести статику в сборку (например, Vite/React) при необходимости richer-UI.

## GitHub
После проверки локально загрузите репозиторий на GitHub, например:
```
git init
git add .
git commit -m "Blog app"
git branch -M main
git remote add origin https://github.com/<your-user>/<repo>.git
git push -u origin main
```


